[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site"
  },
  {
    "objectID": "map_mapview.html",
    "href": "map_mapview.html",
    "title": "Leaflet Map with EJ Data",
    "section": "",
    "text": "The data is from \nTo download the lates data folder, go to , although it is not expected that the data has been updated.\n\n\nShow the code\nlibrary(sf)\n\n\nLinking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE\n\n\nShow the code\nlibrary(mapview)\nlibrary(terra)\n\n\nterra 1.8.15\n\n\nShow the code\nlibrary(dplyr)\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:terra':\n\n    intersect, union\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n\nShow the code\nlibrary(mapview)\n\n\n# Load spatial EJ data\nej_data_sp &lt;- read_sf(\"data/ej_cases/ej_data_public.gpkg\")\n\n# Load biodiversity data\nbiodiv &lt;- rast(\"data/important_biodiversity_areas/minshort_speciestargetswithPA_esh10km_repruns10_ranked.tif\")\n\n# Define robin projection\nrobin &lt;- \"+proj=robin +lon_0=0 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs\"\n\n# Transform to Robinson projection\nej_data_sp_robin &lt;- sf::st_transform(ej_data_sp, crs = robin) |&gt;\n  dplyr::mutate(\n    symbol = dplyr::case_when(\n      cluster == \"Reform cases\" ~ 16,\n      cluster == \"Resists cases\" ~ 15,\n      cluster == \"Transform cases\" ~ 17,\n      TRUE ~ NA_real_ # Default case (optional)\n    )\n  )\n\nbiodiv_robin &lt;- project(biodiv, robin)\n\n# Bin ranked priority areas (1-100) into 5 classes\nfactor_robin &lt;- biodiv_robin |&gt;\n  tidyterra::mutate(\n    cats = cut(\n      minshort_speciestargetswithPA_esh10km_repruns10_ranked,\n      breaks = c(0, 10, 40, 60, 90, 100),\n      labels = c(\"Very High\", \"High\", \"Average\", \"Low\", \"Very Low\")\n    )\n  ) |&gt;\n  mutate(cats = factor(cats, levels = c(\"Very High\", \"High\", \"Average\", \"Low\", \"Very Low\")))\n\n# breaks &lt;- c(0, 10, 40, 60, 90, 100)\n# labels &lt;- c(\"Very High\", \"High\", \"Average\", \"Low\", \"Very Low\")\n# rcl &lt;- data.frame(from = breaks[-length(breaks)], to = breaks[-1], becomes = 1:(length(breaks) - 1))\n# biodiv_class &lt;- classify(biodiv_robin, rcl = rcl)\n\n# Create a mapview map\nmapviewOptions(legend = TRUE, basemaps = \"OpenStreetMap\")\n# levels(biodiv_class) &lt;- labels\n# biodiv_class &lt;- terra::as.factor(biodiv_class)\n\nmap &lt;- mapview(factor_robin, col.regions = c(\"#2ca25f\", \"#74c476\", \"#a1d99b\", \"#c7e9c0\", \"#edf8e9\"), na.omit = TRUE, layer.name = \"values\") +\n  mapview(ej_data_sp_robin, zcol = \"cluster\", col.regions = c(\"black\", \"pink\", \"blue\"), pch = ej_data_sp_robin$symbol, layer.name = \"Cluster\")\n\n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 12848430 to avoid this.\n\n\nShow the code\nmap"
  },
  {
    "objectID": "map_leaflet.html",
    "href": "map_leaflet.html",
    "title": "Leaflet Map with EJ Data",
    "section": "",
    "text": "The data is from \nTo download the lates data folder, go to , although it is not expected that the data has been updated.\n\n\nShow the code\nlibrary(sf)\n\n\nLinking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE\n\n\nShow the code\nlibrary(leaflet)\nlibrary(terra)\n\n\nterra 1.8.15\n\n\nShow the code\nlibrary(dplyr)\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:terra':\n\n    intersect, union\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n\nShow the code\n# Load spatial EJ data\nej_data_sp &lt;- read_sf(\"data/ej_cases/ej_data_public.gpkg\")\n\n# Define custom markers for EJ data\nicons &lt;- awesomeIcons(\n  icon = ~ case_when(\n    ej_data_sp$cluster == \"Reform cases\" ~ \"images/circle-svgrepo-com.svg\",\n    ej_data_sp$cluster == \"Resists cases\" ~ \"images/square-svgrepo-com.svg\",\n    ej_data_sp$cluster == \"Transform cases\" ~ \"images/circle-svgrepo-com.svg\",\n    TRUE ~ \"question-circle\"\n  ),\n  iconColor = \"white\",\n  library = \"fa\",\n  markerColor = \"transparent\"\n)\n\n# Load biodiversity data\nbiodiv &lt;- rast(\"data/important_biodiversity_areas/minshort_speciestargetswithPA_esh10km_repruns10_ranked.tif\")\n\n# Define projections\nweb_mercator &lt;- 4326 # EPSG:4326 for Leaflet '+proj=longlat +datum=WGS84'\n\n# Reproject biodiversity raster to Web Mercator\nbiodiv_web &lt;- project(biodiv, paste0(\"EPSG:\", web_mercator))\n\n# Bin ranked priority areas (1-100) into 5 classes\nbiodiv_web &lt;- biodiv_web |&gt;\n  tidyterra::mutate(\n    cats = cut(\n      minshort_speciestargetswithPA_esh10km_repruns10_ranked,\n      breaks = c(0, 10, 40, 60, 90, 100),\n      labels = c(\"Very High\", \"High\", \"Average\", \"Low\", \"Very Low\")\n    )\n  ) |&gt;\n  mutate(cats = factor(cats, levels = c(\"Very High\", \"High\", \"Average\", \"Low\", \"Very Low\")))\n\n# Create Leaflet map\nleaflet() |&gt;\n  # addTiles() |&gt;\n  # Add biodiversity raster layer\n  addRasterImage(\n    biodiv_web,\n    colors = c(\"#2ca25f\", \"#74c476\", \"#a1d99b\", \"#c7e9c0\", \"#edf8e9\"),\n    opacity = 0.7,\n    layerId = \"Biodiversity\"\n  ) |&gt;\n  # Add legend for raster\n  addLegend(position = \"bottomright\",\n            colors = c(\"#2ca25f\", \"#74c476\", \"#a1d99b\", \"#c7e9c0\", \"#edf8e9\"),\n            labels = c(\"Very High\", \"High\", \"Average\", \"Low\", \"Very Low\"),\n            title = \"Biodiversity Priority\",\n            opacity = 0.7,\n            className = \"info legend\") |&gt;\n  # Add legend for EJ clusters\n  addLegend(position = \"bottomright\",\n            colors = c(\"black\", \"pink\", \"blue\"),\n            labels = c(\"Reform cases\", \"Resists cases\", \"Transform cases\"),\n            title = \"EJ Cluster\",\n            opacity = 0.7,\n            className = \"info legend\") |&gt;\n  # Add EJ spatial points with custom markers\n  addCircleMarkers(\n    data = ej_data_sp,\n    color = ~case_when(\n      cluster == \"Reform cases\" ~ \"black\",\n      cluster == \"Resists cases\" ~ \"pink\",\n      cluster == \"Transform cases\" ~ \"blue\",\n      TRUE ~ \"gray\"\n    ),\n    radius = 6,\n    fillOpacity = 0.5,\n    label = ~cluster\n  ) |&gt;\n  \n  # Set initial view\n  setView(lng = 0, lat = 0, zoom = 2)\n\n\nWarning: using the first layer in 'x'"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "IPBES TCA Figure SPM.11 Dynamic",
    "section": "",
    "text": "Two maps using two packages\n\nleaflet map\nmapview map"
  }
]